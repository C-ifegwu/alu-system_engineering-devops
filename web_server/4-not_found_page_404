#!/usr/bin/env bash
# This script configures nginx to use a custom 404 page that returns "Ceci n'est pas une page" with an HTTP 404 status.
NGINX_CONF="/etc/nginx/sites-available/default"
cp "$NGINX_CONF" "${NGINX_CONF}.bak2"

# Create the custom 404 page
echo "Ceci n'est pas une page" > /var/www/html/404.html

# Insert the error_page directive and location block into the server block
sed -i '/server {/a \
    error_page 404 /404.html;\
    location = /404.html {\
        internal;\
    }' "$NGINX_CONF"

# Restart nginx using the service command
service nginx restart
